# 游戏中异步加载资源容易发生的错误

## 问题

1.今天使用`addImageAsync(name, CC_CALLBACK_1(LoadScene::plistImageAsyncCallback2, this))`异步加载纹理，使用循环来使用此方法，定义一个全局变量i来记住循环的次数，并且在`plistImageAsyncCallback2plistImageAsyncCallback2(cocos2d::Texture2D* texture)`方法中使用`addSpriteFramesWithFile(name, texture)`加载plist，但是`plistImageAsyncCallback2plistImageAsyncCallback2(cocos2d::Texture2D* texture)`中使用的是全局变量i来逐个记载plist，最后发现只加载了最后一个plist文件，之前的都没有加载到。

## 问题原因

1.因为是异步加载的因素，当所有addImageAsync方法执行完了以后里面的异步方法plistImageAsyncCallback2plistImageAsyncCallback2还不一定执行，所以当第一个plistImageAsyncCallback2plistImageAsyncCallback2方法执行的时候全局变量i已经不是第一次的循环数了，他就会加载当前i所指向的plist，所以会跳过之前的plist加载。

## 解决问题

1.在循环里定义局部变量来计算循环数，而全局变量i来记录plistImageAsyncCallback2plistImageAsyncCallback2中加载plist的次数。